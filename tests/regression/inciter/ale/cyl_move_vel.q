# vim: filetype=sh:
# This is a comment
# Keywords are case-sensitive

title "ALE moving boundary with a prescribed velocity"

inciter

  term 12.566 # = 4*pi
  nstep 10
  cfl 0.5
  ttyi 1

  scheme alecg

  partitioning
    algorithm mj
  end

  ale
    dvcfl 1.0
    mesh_velocity user_defined
    smoother laplace
    mesh_motion 1 2 end
    maxit 5  # for cyl_thin_9k.exo
    #maxit 12  # for cyl_thin_207k.exo
    tolerance 0.01
    bc_sym
      sideset 1 3 4 5 6 7 end
    end
    move
      sideset 2 end
      fntype velocity
      # The function below prescribes a discrete 3-scalar-valued function,
      # f:R->R^3, in time as f(x,y,z) = (0,sin(t),cos(t)) between t=[0...2pi),
      # followed by f(x,y,z)=(0,-sin(t),cos(t)) between t=[2pi...4pi). This is
      # used to prescibe the mesh velocity for a side set (the center hole of a
      # flow around a cylinder moving in time following a shape of the number 8.
      fn # t         x(t) y(t)        z(t)
           0         0    0           1
           0.0634665 0    0.0634239   0.997987
           0.126933  0    0.126592    0.991955
           0.1904    0    0.189251    0.981929
           0.253866  0    0.251148    0.967949
           0.317333  0    0.312033    0.950071
           0.380799  0    0.371662    0.928368
           0.444266  0    0.429795    0.902927
           0.507732  0    0.486197    0.873849
           0.571199  0    0.540641    0.841254
           0.634665  0    0.592908    0.80527 
           0.698132  0    0.642788    0.766044
           0.761598  0    0.690079    0.723734
           0.825065  0    0.734592    0.678509
           0.888531  0    0.776146    0.630553
           0.951998  0    0.814576    0.580057
           1.01546   0    0.849725    0.527225
           1.07893   0    0.881453    0.472271
           1.1424    0    0.909632    0.415415
           1.20586   0    0.934148    0.356886
           1.26933   0    0.954902    0.29692 
           1.3328    0    0.971812    0.235759
           1.39626   0    0.984808    0.173648
           1.45973   0    0.993838    0.110838
           1.5232    0    0.998867    0.047581
           1.58666   0    0.999874   -0.015866
           1.65013   0    0.996855   -0.07925 
           1.7136    0    0.989821   -0.142315
           1.77706   0    0.978802   -0.204807
           1.84053   0    0.963842   -0.266474
           1.904     0    0.945001   -0.327068
           1.96746   0    0.922354   -0.386345
           2.03093   0    0.895994   -0.444067
           2.0944    0    0.866025   -0.5
           2.15786   0    0.83257    -0.55392
           2.22133   0    0.795762   -0.60561
           2.28479   0    0.75575    -0.654861
           2.34826   0    0.712694   -0.701475
           2.41173   0    0.666769   -0.745264
           2.47519   0    0.618159   -0.786053
           2.53866   0    0.56706    -0.823677
           2.60213   0    0.513677   -0.857983
           2.66559   0    0.458227   -0.888835
           2.72906   0    0.400931   -0.916108
           2.79253   0    0.34202    -0.939693
           2.85599   0    0.281733   -0.959493
           2.91946   0    0.220311   -0.97543
           2.98293   0    0.158001   -0.987439
           3.04639   0    0.095056   -0.995472
           3.10986   0    0.0317279  -0.999497
           3.17333   0   -0.0317279  -0.999497
           3.23679   0   -0.095056   -0.995472
           3.30026   0   -0.158001   -0.987439
           3.36373   0   -0.220311   -0.97543
           3.42719   0   -0.281733   -0.959493
           3.49066   0   -0.34202    -0.939693
           3.55413   0   -0.400931   -0.916108
           3.61759   0   -0.458227   -0.888835
           3.68106   0   -0.513677   -0.857983
           3.74452   0   -0.56706    -0.823677
           3.80799   0   -0.618159   -0.786053
           3.87146   0   -0.666769   -0.745264
           3.93492   0   -0.712694   -0.701475
           3.99839   0   -0.75575    -0.654861
           4.06186   0   -0.795762   -0.60561
           4.12532   0   -0.83257    -0.55392 
           4.18879   0   -0.866025   -0.5
           4.25226   0   -0.895994   -0.444067
           4.31572   0   -0.922354   -0.386345
           4.37919   0   -0.945001   -0.327068
           4.44266   0   -0.963842   -0.266474
           4.50612   0   -0.978802   -0.204807
           4.56959   0   -0.989821   -0.142315
           4.63306   0   -0.996855   -0.07925
           4.69652   0   -0.999874   -0.015866
           4.75999   0   -0.998867    0.0475819
           4.82346   0   -0.993838    0.110838
           4.88692   0   -0.984808    0.173648
           4.95039   0   -0.971812    0.235759
           5.01385   0   -0.954902    0.29692
           5.07732   0   -0.934148    0.356886
           5.14079   0   -0.909632    0.415415
           5.20425   0   -0.881453    0.472271
           5.26772   0   -0.849725    0.527225
           5.33119   0   -0.814576    0.580057
           5.39465   0   -0.776146    0.630553
           5.45812   0   -0.734592    0.678509
           5.52159   0   -0.690079    0.723734
           5.58505   0   -0.642788    0.766044
           5.64852   0   -0.592908    0.80527
           5.71199   0   -0.540641    0.841254
           5.77545   0   -0.486197    0.873849
           5.83892   0   -0.429795    0.902927
           5.90239   0   -0.371662    0.928368
           5.96585   0   -0.312033    0.950071
           6.02932   0   -0.251148    0.967949
           6.09279   0   -0.189251    0.981929
           6.15625   0   -0.126592    0.991955
           6.21972   0   -0.0634239   0.997987
           6.28319   0    0           1

           6.34665   0   -0.0634239   0.997987
           6.41012   0   -0.126592    0.991955
           6.47358   0   -0.189251    0.981929
           6.53705   0   -0.251148    0.967949
           6.60052   0   -0.312033    0.950071
           6.66398   0   -0.371662    0.928368
           6.72745   0   -0.429795    0.902927
           6.79092   0   -0.486197    0.873849
           6.85438   0   -0.540641    0.841254
           6.91785   0   -0.592908    0.80527
           6.98132   0   -0.642788    0.766044
           7.04478   0   -0.690079    0.723734
           7.10825   0   -0.734592    0.678509
           7.17172   0   -0.776146    0.630553
           7.23518   0   -0.814576    0.580057
           7.29865   0   -0.849725    0.527225
           7.36212   0   -0.881453    0.472271
           7.42558   0   -0.909632    0.415415
           7.48905   0   -0.934148    0.356886
           7.55252   0   -0.954902    0.29692
           7.61598   0   -0.971812    0.235759
           7.67945   0   -0.984808    0.173648
           7.74292   0   -0.993838    0.110838
           7.80638   0   -0.998867    0.0475819
           7.86985   0   -0.999874   -0.015866
           7.93331   0   -0.996855   -0.07925
           7.99678   0   -0.989821   -0.142315
           8.06025   0   -0.978802   -0.204807
           8.12371   0   -0.963842   -0.266474
           8.18718   0   -0.945001   -0.327068
           8.25065   0   -0.922354   -0.386345
           8.31411   0   -0.895994   -0.444067
           8.37758   0   -0.866025   -0.5
           8.44105   0   -0.83257    -0.55392
           8.50451   0   -0.795762   -0.60561
           8.56798   0   -0.75575    -0.654861
           8.63145   0   -0.712694   -0.701475
           8.69491   0   -0.666769   -0.745264
           8.75838   0   -0.618159   -0.786053
           8.82185   0   -0.56706    -0.823677
           8.88531   0   -0.513677   -0.857983
           8.94878   0   -0.458227   -0.888835
           9.01225   0   -0.400931   -0.916108
           9.07571   0   -0.34202    -0.939693
           9.13918   0   -0.281733   -0.959493
           9.20265   0   -0.220311   -0.97543
           9.26611   0   -0.158001   -0.987439
           9.32958   0   -0.095056   -0.995472
           9.39304   0   -0.0317279  -0.999497
           9.45651   0    0.0317279  -0.999497
           9.51998   0    0.095056   -0.995472
           9.58344   0    0.158001   -0.987439
           9.64691   0    0.220311   -0.97543
           9.71038   0    0.281733   -0.959493
           9.77384   0    0.34202    -0.939693
           9.83731   0    0.400931   -0.916108
           9.90078   0    0.458227   -0.888835
           9.96424   0    0.513677   -0.857983
           10.0277   0    0.56706    -0.823677
           10.0912   0    0.618159   -0.786053
           10.1546   0    0.666769   -0.745264
           10.2181   0    0.712694   -0.701475
           10.2816   0    0.75575    -0.654861
           10.345    0    0.795762   -0.60561
           10.4085   0    0.83257    -0.55392
           10.472    0    0.866025   -0.5
           10.5354   0    0.895994   -0.444067
           10.5989   0    0.922354   -0.386345
           10.6624   0    0.945001   -0.327068
           10.7258   0    0.963842   -0.266474
           10.7893   0    0.978802   -0.204807
           10.8528   0    0.989821   -0.142315
           10.9162   0    0.996855   -0.07925
           10.9797   0    0.999874   -0.015866
           11.0432   0    0.998867    0.0475819
           11.1066   0    0.993838    0.110838
           11.1701   0    0.984808    0.173648
           11.2336   0    0.971812    0.235759
           11.297    0    0.954902    0.29692
           11.3605   0    0.934148    0.356886
           11.424    0    0.909632    0.415415
           11.4874   0    0.881453    0.472271
           11.5509   0    0.849725    0.527225
           11.6144   0    0.814576    0.580057
           11.6778   0    0.776146    0.630553
           11.7413   0    0.734592    0.678509
           11.8048   0    0.690079    0.723734
           11.8682   0    0.642788    0.766044
           11.9317   0    0.592908    0.80527
           11.9952   0    0.540641    0.841254
           12.0586   0    0.486197    0.873849
           12.1221   0    0.429795    0.902927
           12.1856   0    0.371662    0.928368
           12.249    0    0.312033    0.950071
           12.3125   0    0.251148    0.967949
           12.376    0    0.189251    0.981929
           12.4394   0    0.126592    0.991955
           12.5029   0    0.0634239   0.997987
           12.5664   0    0           1
      end
    end
  end

  compflow
    mesh filename "cyl_thin_9k.exo" end
    #mesh filename "cyl_thin_207k.exo" end
    physics euler
    ic
      density 1.0 end
      velocity 0.0 0.0 0.0 end
      pressure 1.0 end
    end
    material
      gamma 1.4 end
    end
    bc_sym
      sideset 1 2 3 4 5 6 7 end
    end
  end

  diagnostics
    interval  1
    format    scientific
    error l2
  end

  field_output
    interval 5
    var
      density
      x-velocity
      y-velocity
      z-velocity
      specific_total_energy
      pressure
   end
  end

end
