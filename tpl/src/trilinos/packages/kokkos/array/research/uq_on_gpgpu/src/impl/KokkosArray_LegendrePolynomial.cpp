/*
//@HEADER
// ************************************************************************
// 
//          Kokkos: Node API and Parallel Node Kernels
//              Copyright (2008) Sandia Corporation
// 
// Under the terms of Contract DE-AC04-94AL85000 with Sandia Corporation,
// the U.S. Government retains certain rights in this software.
// 
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are
// met:
//
// 1. Redistributions of source code must retain the above copyright
// notice, this list of conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright
// notice, this list of conditions and the following disclaimer in the
// documentation and/or other materials provided with the distribution.
//
// 3. Neither the name of the Corporation nor the names of the
// contributors may be used to endorse or promote products derived from
// this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY SANDIA CORPORATION "AS IS" AND ANY
// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
// PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL SANDIA CORPORATION OR THE
// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
// Questions? Contact Michael A. Heroux (maherou@sandia.gov) 
// 
// ************************************************************************
//@HEADER
*/


#include <KokkosArray_LegendrePolynomial.hpp>
#include <sstream>
#include <stdexcept>

namespace KokkosArray {
namespace Impl {

namespace {

const double points_n1[] = { 0 };
const double weights_n1[] = { 2 };

const double points_n2[] = {
       -0.5773502691896257 ,
        0.5773502691896257 };
const double weights_n2[] = {
        1.0000000000000000 ,
        1.0000000000000000 } /* 2.000000000000000 */ ;

const double points_n3[] = {
       -0.7745966692414834 ,
        0.0000000000000000 ,
        0.7745966692414834 };
const double weights_n3[] = {
        0.5555555555555556 ,
        0.8888888888888888 ,
        0.5555555555555556 } /* 2.000000000000000 */ ;

const double points_n4[] = {
       -0.8611363115940526 ,
       -0.3399810435848563 ,
        0.3399810435848563 ,
        0.8611363115940526 };
const double weights_n4[] = {
        0.3478548451374538 ,
        0.6521451548625461 ,
        0.6521451548625461 ,
        0.3478548451374538 } /* 2.000000000000000 */ ;

const double points_n5[] = {
       -0.9061798459386640 ,
       -0.5384693101056831 ,
        0.0000000000000000 ,
        0.5384693101056831 ,
        0.9061798459386640 };
const double weights_n5[] = {
        0.2369268850561891 ,
        0.4786286704993665 ,
        0.5688888888888889 ,
        0.4786286704993665 ,
        0.2369268850561891 } /* 2.000000000000000 */ ;

const double points_n6[] = {
       -0.9324695142031521 ,
       -0.6612093864662645 ,
       -0.2386191860831969 ,
        0.2386191860831969 ,
        0.6612093864662645 ,
        0.9324695142031521 };
const double weights_n6[] = {
        0.1713244923791704 ,
        0.3607615730481386 ,
        0.4679139345726910 ,
        0.4679139345726910 ,
        0.3607615730481386 ,
        0.1713244923791704 } /* 2.000000000000000 */ ;

const double points_n7[] = {
       -0.9491079123427585 ,
       -0.7415311855993945 ,
       -0.4058451513773972 ,
        0.0000000000000000 ,
        0.4058451513773972 ,
        0.7415311855993945 ,
        0.9491079123427585 };
const double weights_n7[] = {
        0.1294849661688697 ,
        0.2797053914892766 ,
        0.3818300505051189 ,
        0.4179591836734694 ,
        0.3818300505051189 ,
        0.2797053914892766 ,
        0.1294849661688697 } /* 2.000000000000000 */ ;

const double points_n8[] = {
       -0.9602898564975363 ,
       -0.7966664774136267 ,
       -0.5255324099163290 ,
       -0.1834346424956498 ,
        0.1834346424956498 ,
        0.5255324099163290 ,
        0.7966664774136267 ,
        0.9602898564975363 };
const double weights_n8[] = {
        0.1012285362903763 ,
        0.2223810344533745 ,
        0.3137066458778873 ,
        0.3626837833783620 ,
        0.3626837833783620 ,
        0.3137066458778873 ,
        0.2223810344533745 ,
        0.1012285362903763 } /* 2.000000000000000 */ ;

const double points_n9[] = {
       -0.9681602395076261 ,
       -0.8360311073266358 ,
       -0.6133714327005904 ,
       -0.3242534234038089 ,
        0.0000000000000000 ,
        0.3242534234038089 ,
        0.6133714327005904 ,
        0.8360311073266358 ,
        0.9681602395076261 };
const double weights_n9[] = {
        0.0812743883615744 ,
        0.1806481606948574 ,
        0.2606106964029354 ,
        0.3123470770400029 ,
        0.3302393550012598 ,
        0.3123470770400029 ,
        0.2606106964029354 ,
        0.1806481606948574 ,
        0.0812743883615744 } /* 2.000000000000000 */ ;

const double points_n10[] = {
       -0.9739065285171717 ,
       -0.8650633666889845 ,
       -0.6794095682990244 ,
       -0.4333953941292472 ,
       -0.1488743389816312 ,
        0.1488743389816312 ,
        0.4333953941292472 ,
        0.6794095682990244 ,
        0.8650633666889845 ,
        0.9739065285171717 };
const double weights_n10[] = {
        0.0666713443086881 ,
        0.1494513491505806 ,
        0.2190863625159820 ,
        0.2692667193099963 ,
        0.2955242247147529 ,
        0.2955242247147529 ,
        0.2692667193099963 ,
        0.2190863625159820 ,
        0.1494513491505806 ,
        0.0666713443086881 } /* 2.000000000000000 */ ;

const double points_n11[] = {
       -0.9782286581460570 ,
       -0.8870625997680953 ,
       -0.7301520055740494 ,
       -0.5190961292068118 ,
       -0.2695431559523450 ,
        0.0000000000000000 ,
        0.2695431559523450 ,
        0.5190961292068118 ,
        0.7301520055740494 ,
        0.8870625997680953 ,
        0.9782286581460570 };
const double weights_n11[] = {
        0.0556685671161737 ,
        0.1255803694649046 ,
        0.1862902109277343 ,
        0.2331937645919905 ,
        0.2628045445102467 ,
        0.2729250867779006 ,
        0.2628045445102467 ,
        0.2331937645919905 ,
        0.1862902109277343 ,
        0.1255803694649046 ,
        0.0556685671161737 } /* 2.000000000000000 */ ;

const double points_n12[] = {
       -0.9815606342467192 ,
       -0.9041172563704749 ,
       -0.7699026741943047 ,
       -0.5873179542866175 ,
       -0.3678314989981802 ,
       -0.1252334085114689 ,
        0.1252334085114689 ,
        0.3678314989981802 ,
        0.5873179542866175 ,
        0.7699026741943047 ,
        0.9041172563704749 ,
        0.9815606342467192 };
const double weights_n12[] = {
        0.0471753363865118 ,
        0.1069393259953184 ,
        0.1600783285433462 ,
        0.2031674267230659 ,
        0.2334925365383548 ,
        0.2491470458134028 ,
        0.2491470458134028 ,
        0.2334925365383548 ,
        0.2031674267230659 ,
        0.1600783285433462 ,
        0.1069393259953184 ,
        0.0471753363865118 } /* 2.000000000000000 */ ;

const double points_n13[] = {
       -0.9841830547185881 ,
       -0.9175983992229779 ,
       -0.8015780907333099 ,
       -0.6423493394403402 ,
       -0.4484927510364469 ,
       -0.2304583159551348 ,
        0.0000000000000000 ,
        0.2304583159551348 ,
        0.4484927510364469 ,
        0.6423493394403402 ,
        0.8015780907333099 ,
        0.9175983992229779 ,
        0.9841830547185881 };
const double weights_n13[] = {
        0.0404840047653159 ,
        0.0921214998377285 ,
        0.1388735102197872 ,
        0.1781459807619457 ,
        0.2078160475368885 ,
        0.2262831802628972 ,
        0.2325515532308739 ,
        0.2262831802628972 ,
        0.2078160475368885 ,
        0.1781459807619457 ,
        0.1388735102197872 ,
        0.0921214998377285 ,
        0.0404840047653159 } /* 2.000000000000000 */ ;

const double points_n14[] = {
       -0.9862838086968123 ,
       -0.9284348836635735 ,
       -0.8272013150697650 ,
       -0.6872929048116855 ,
       -0.5152486363581541 ,
       -0.3191123689278897 ,
       -0.1080549487073437 ,
        0.1080549487073437 ,
        0.3191123689278897 ,
        0.5152486363581541 ,
        0.6872929048116855 ,
        0.8272013150697650 ,
        0.9284348836635735 ,
        0.9862838086968123 };
const double weights_n14[] = {
        0.0351194603317519 ,
        0.0801580871597602 ,
        0.1215185706879032 ,
        0.1572031671581935 ,
        0.1855383974779378 ,
        0.2051984637212956 ,
        0.2152638534631578 ,
        0.2152638534631578 ,
        0.2051984637212956 ,
        0.1855383974779378 ,
        0.1572031671581935 ,
        0.1215185706879032 ,
        0.0801580871597602 ,
        0.0351194603317519 } /* 2.000000000000000 */ ;

const double points_n15[] = {
       -0.9879925180204854 ,
       -0.9372733924007060 ,
       -0.8482065834104272 ,
       -0.7244177313601701 ,
       -0.5709721726085388 ,
       -0.3941513470775634 ,
       -0.2011940939974345 ,
        0.0000000000000000 ,
        0.2011940939974345 ,
        0.3941513470775634 ,
        0.5709721726085388 ,
        0.7244177313601701 ,
        0.8482065834104272 ,
        0.9372733924007060 ,
        0.9879925180204854 };
const double weights_n15[] = {
        0.0307532419961173 ,
        0.0703660474881081 ,
        0.1071592204671719 ,
        0.1395706779261543 ,
        0.1662692058169939 ,
        0.1861610000155622 ,
        0.1984314853271116 ,
        0.2025782419255613 ,
        0.1984314853271116 ,
        0.1861610000155622 ,
        0.1662692058169939 ,
        0.1395706779261543 ,
        0.1071592204671719 ,
        0.0703660474881081 ,
        0.0307532419961173 } /* 2.000000000000000 */ ;

const double points_n16[] = {
       -0.9894009349916499 ,
       -0.9445750230732326 ,
       -0.8656312023878318 ,
       -0.7554044083550030 ,
       -0.6178762444026438 ,
       -0.4580167776572274 ,
       -0.2816035507792589 ,
       -0.0950125098376374 ,
        0.0950125098376374 ,
        0.2816035507792589 ,
        0.4580167776572274 ,
        0.6178762444026438 ,
        0.7554044083550030 ,
        0.8656312023878318 ,
        0.9445750230732326 ,
        0.9894009349916499 };
const double weights_n16[] = {
        0.0271524594117541 ,
        0.0622535239386479 ,
        0.0951585116824928 ,
        0.1246289712555339 ,
        0.1495959888165767 ,
        0.1691565193950025 ,
        0.1826034150449236 ,
        0.1894506104550685 ,
        0.1894506104550685 ,
        0.1826034150449236 ,
        0.1691565193950025 ,
        0.1495959888165767 ,
        0.1246289712555339 ,
        0.0951585116824928 ,
        0.0622535239386479 ,
        0.0271524594117541 } /* 2.000000000000000 */ ;

const double points_n17[] = {
       -0.9905754753144174 ,
       -0.9506755217687678 ,
       -0.8802391537269859 ,
       -0.7815140038968014 ,
       -0.6576711592166907 ,
       -0.5126905370864769 ,
       -0.3512317634538763 ,
       -0.1784841814958479 ,
        0.0000000000000000 ,
        0.1784841814958479 ,
        0.3512317634538763 ,
        0.5126905370864769 ,
        0.6576711592166907 ,
        0.7815140038968014 ,
        0.8802391537269859 ,
        0.9506755217687678 ,
        0.9905754753144174 };
const double weights_n17[] = {
        0.0241483028685479 ,
        0.0554595293739872 ,
        0.0850361483171792 ,
        0.1118838471934040 ,
        0.1351363684685255 ,
        0.1540457610768103 ,
        0.1680041021564500 ,
        0.1765627053669926 ,
        0.1794464703562065 ,
        0.1765627053669926 ,
        0.1680041021564500 ,
        0.1540457610768103 ,
        0.1351363684685255 ,
        0.1118838471934040 ,
        0.0850361483171792 ,
        0.0554595293739872 ,
        0.0241483028685479 } /* 2.000000000000000 */ ;

const double points_n18[] = {
       -0.9915651684209309 ,
       -0.9558239495713977 ,
       -0.8926024664975557 ,
       -0.8037049589725231 ,
       -0.6916870430603532 ,
       -0.5597708310739475 ,
       -0.4117511614628426 ,
       -0.2518862256915055 ,
       -0.0847750130417353 ,
        0.0847750130417353 ,
        0.2518862256915055 ,
        0.4117511614628426 ,
        0.5597708310739475 ,
        0.6916870430603532 ,
        0.8037049589725231 ,
        0.8926024664975557 ,
        0.9558239495713977 ,
        0.9915651684209309 };
const double weights_n18[] = {
        0.0216160135264833 ,
        0.0497145488949698 ,
        0.0764257302548891 ,
        0.1009420441062872 ,
        0.1225552067114785 ,
        0.1406429146706507 ,
        0.1546846751262652 ,
        0.1642764837458327 ,
        0.1691423829631436 ,
        0.1691423829631436 ,
        0.1642764837458327 ,
        0.1546846751262652 ,
        0.1406429146706507 ,
        0.1225552067114785 ,
        0.1009420441062872 ,
        0.0764257302548891 ,
        0.0497145488949698 ,
        0.0216160135264833 } /* 2.000000000000000 */ ;

const double points_n19[] = {
       -0.9924068438435844 ,
       -0.9602081521348300 ,
       -0.9031559036148179 ,
       -0.8227146565371428 ,
       -0.7209661773352294 ,
       -0.6005453046616810 ,
       -0.4645707413759609 ,
       -0.3165640999636298 ,
       -0.1603586456402254 ,
        0.0000000000000000 ,
        0.1603586456402254 ,
        0.3165640999636298 ,
        0.4645707413759609 ,
        0.6005453046616810 ,
        0.7209661773352294 ,
        0.8227146565371428 ,
        0.9031559036148179 ,
        0.9602081521348300 ,
        0.9924068438435844 };
const double weights_n19[] = {
        0.0194617882297265 ,
        0.0448142267656996 ,
        0.0690445427376412 ,
        0.0914900216224500 ,
        0.1115666455473340 ,
        0.1287539625393362 ,
        0.1426067021736066 ,
        0.1527660420658597 ,
        0.1589688433939543 ,
        0.1610544498487837 ,
        0.1589688433939543 ,
        0.1527660420658597 ,
        0.1426067021736066 ,
        0.1287539625393362 ,
        0.1115666455473340 ,
        0.0914900216224500 ,
        0.0690445427376412 ,
        0.0448142267656996 ,
        0.0194617882297265 } /* 2.000000000000000 */ ;

const double points_n20[] = {
       -0.9931285991850949 ,
       -0.9639719272779138 ,
       -0.9122344282513259 ,
       -0.8391169718222188 ,
       -0.7463319064601508 ,
       -0.6360536807265150 ,
       -0.5108670019508271 ,
       -0.3737060887154195 ,
       -0.2277858511416451 ,
       -0.0765265211334973 ,
        0.0765265211334973 ,
        0.2277858511416451 ,
        0.3737060887154195 ,
        0.5108670019508271 ,
        0.6360536807265150 ,
        0.7463319064601508 ,
        0.8391169718222188 ,
        0.9122344282513259 ,
        0.9639719272779138 ,
        0.9931285991850949 };
const double weights_n20[] = {
        0.0176140071391521 ,
        0.0406014298003869 ,
        0.0626720483341091 ,
        0.0832767415767048 ,
        0.1019301198172404 ,
        0.1181945319615184 ,
        0.1316886384491766 ,
        0.1420961093183820 ,
        0.1491729864726037 ,
        0.1527533871307258 ,
        0.1527533871307258 ,
        0.1491729864726037 ,
        0.1420961093183820 ,
        0.1316886384491766 ,
        0.1181945319615184 ,
        0.1019301198172404 ,
        0.0832767415767048 ,
        0.0626720483341091 ,
        0.0406014298003869 ,
        0.0176140071391521 } /* 2.000000000000000 */ ;

const double points_n32[] = {
       -0.9972638618494816 ,
       -0.9856115115452684 ,
       -0.9647622555875064 ,
       -0.9349060759377397 ,
       -0.8963211557660521 ,
       -0.8493676137325700 ,
       -0.7944837959679424 ,
       -0.7321821187402897 ,
       -0.6630442669302152 ,
       -0.5877157572407623 ,
       -0.5068999089322294 ,
       -0.4213512761306353 ,
       -0.3318686022821277 ,
       -0.2392873622521371 ,
       -0.1444719615827965 ,
       -0.0483076656877383 ,
        0.0483076656877383 ,
        0.1444719615827965 ,
        0.2392873622521371 ,
        0.3318686022821277 ,
        0.4213512761306353 ,
        0.5068999089322294 ,
        0.5877157572407623 ,
        0.6630442669302152 ,
        0.7321821187402897 ,
        0.7944837959679424 ,
        0.8493676137325700 ,
        0.8963211557660521 ,
        0.9349060759377397 ,
        0.9647622555875064 ,
        0.9856115115452684 ,
        0.9972638618494816 };
const double weights_n32[] = {
        0.0070186100094701 ,
        0.0162743947309057 ,
        0.0253920653092621 ,
        0.0342738629130214 ,
        0.0428358980222267 ,
        0.0509980592623762 ,
        0.0586840934785355 ,
        0.0658222227763618 ,
        0.0723457941088485 ,
        0.0781938957870703 ,
        0.0833119242269467 ,
        0.0876520930044038 ,
        0.0911738786957639 ,
        0.0938443990808046 ,
        0.0956387200792749 ,
        0.0965400885147278 ,
        0.0965400885147278 ,
        0.0956387200792749 ,
        0.0938443990808046 ,
        0.0911738786957639 ,
        0.0876520930044038 ,
        0.0833119242269467 ,
        0.0781938957870703 ,
        0.0723457941088485 ,
        0.0658222227763618 ,
        0.0586840934785355 ,
        0.0509980592623762 ,
        0.0428358980222267 ,
        0.0342738629130214 ,
        0.0253920653092621 ,
        0.0162743947309057 ,
        0.0070186100094701 } /* 2.000000000000000 */ ;

const double * points[] =
  { 0 , points_n1 , points_n2 , points_n3 , points_n4 , points_n5 , points_n6 , points_n7 , points_n8 , points_n9 , points_n10 ,
    points_n11 , points_n12 , points_n13 , points_n14 , points_n15 , points_n16 , points_n17 , points_n18 , points_n19 , points_n20};

const double * weights[] =
  { 0 , weights_n1 , weights_n2 , weights_n3 , weights_n4 , weights_n5 , weights_n6 , weights_n7 , weights_n8 , weights_n9 , weights_n10 ,
   weights_n11 , weights_n12 , weights_n13 , weights_n14 , weights_n15 , weights_n16 , weights_n17 , weights_n18 , weights_n19 , weights_n20 };

}


void gauss_legendre( unsigned n , double pt[] , double wgt[] )
{
  if ( 32 == n ) {
    for ( unsigned i = 0 ; i < n ; ++i ) {
      pt[i] = points_n32[i] ;
      wgt[i] = weights_n32[i] ;
    }
  }
  else if ( n <= 20 ) {
    for ( unsigned i = 0 ; i < n ; ++i ) {
      pt[i] = points[n][i] ;
      wgt[i] = weights[n][i] ;
    }
  }
  else {
    std::ostringstream msg ;
    msg << "KokkosArray::Impl::gauss_legendre( " << n << " > maximum(20) )" ;
    throw std::runtime_error( msg.str() );
  }

}

}
}

